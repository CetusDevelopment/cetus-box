import{az as e,ao as a,ap as o,aq as s,ar as t,E as r,aA as i,A as n,r as l,j as c,J as d,X as u,aB as h,F as p,S,M as g,H as P,N as m,C as V,as as f,at as R}from"./index-CIMZsV66.js";import{T as v,u as b}from"./suiClient-CwbLuZrG.js";const{withContext:y}=e({key:"heading"}),E=y("h2");E.displayName="Heading";const w=a()(o(e=>({searchWalletAddress:"",setSearchWalletAddress:a=>{e({searchWalletAddress:a})},searchPoolAddress:"",setSearchPoolAddress:a=>{e({searchPoolAddress:a})},searchPositionId:"",setSearchPositionId:a=>{e({searchPositionId:a})},isDlmm:!1,setIsDlmm:a=>{e({isDlmm:a})},poolYieldData:void 0,setPoolYieldData:a=>{e({poolYieldData:a})},positionYieldData:void 0,setPositionYieldData:a=>{e({positionYieldData:a})},currentPositionData:void 0,setCurrentPositionData:a=>{e({currentPositionData:a})},walletErrorString:void 0,setWalletErrorString:a=>{e({walletErrorString:a})},poolErrorString:void 0,setPoolErrorString:a=>{e({poolErrorString:a})},positionErrorString:void 0,setPositionErrorString:a=>{e({positionErrorString:a})},poolSearchLoading:!1,setPoolSearchLoading:a=>{e({poolSearchLoading:a})},positionSearching:!1,setPositionSearching:a=>{e({positionSearching:a})},poolRecentSearchValues:[],setPoolRecentSearchValues:a=>{e({poolRecentSearchValues:a})},addPoolRecentSearchValue:a=>{e(e=>{const o=t(a);return e.poolRecentSearchValues.some(e=>t(e)===o)?e:{poolRecentSearchValues:[a,...e.poolRecentSearchValues]}})},removePoolRecentSearchValue:a=>{e(e=>({poolRecentSearchValues:e.poolRecentSearchValues.filter(e=>t(e)!==t(a))}))},clearPoolRecentSearchValues:()=>{e({poolRecentSearchValues:[]})},positionRecentSearchValues:[],setPositionRecentSearchValues:a=>{e({positionRecentSearchValues:a})},addPositionRecentSearchValue:a=>{e(e=>{const o=t(a);return e.positionRecentSearchValues.some(e=>t(e)===o)?e:{positionRecentSearchValues:[a,...e.positionRecentSearchValues]}})},removePositionRecentSearchValue:a=>{e(e=>({positionRecentSearchValues:e.positionRecentSearchValues.filter(e=>t(e)!==t(a))}))},clearPositionRecentSearchValues:()=>{e({positionRecentSearchValues:[]})},searchTab:"pool",setSearchTab:a=>{e({searchTab:a})},resetPoolInput:()=>{e({searchWalletAddress:"",searchPoolAddress:"",poolYieldData:void 0,walletErrorString:void 0,poolErrorString:void 0,poolSearchLoading:!1})},resetPositionInput:()=>{e({searchPositionId:"",positionYieldData:void 0,positionErrorString:void 0,positionSearching:!1})},resetInput:()=>{e({searchTab:"pool",searchWalletAddress:"",searchPoolAddress:"",searchPositionId:"",poolYieldData:void 0,positionYieldData:void 0,walletErrorString:void 0,poolErrorString:void 0,positionErrorString:void 0,poolSearchLoading:!1,positionSearching:!1})}}),{name:"useYieldStore",version:1,migrate:(e,a)=>{if(!e)return{poolRecentSearchValues:[],positionRecentSearchValues:[]};if(0===a||!("version"in e)){const a=e.poolRecentSearchValues||[],o=s(a),t=e.positionRecentSearchValues||[],r=s(t);return{...e,poolRecentSearchValues:o,positionRecentSearchValues:r}}return e},partialize:e=>({poolRecentSearchValues:e.poolRecentSearchValues,positionRecentSearchValues:e.positionRecentSearchValues})}));function x(){const{yieldTabs:e,searchTab:a,handleTabChange:o}=function(){const{searchTab:e,setSearchTab:a}=w(),{pathname:o}=r(),s=i(),t=n();return l.useEffect(()=>{o.startsWith("/yield")&&("position"===s?.type?(t("/yield/position"),a("position")):(t("/yield/pool"),a("pool")))},[o,s?.type]),{yieldTabs:[{label:"Pool Yield",value:"pool"},{label:"Position Yield",value:"position"}],searchTab:e,handleTabChange:e=>{a(e.value),o.startsWith("/yield")&&t(`/yield/${e.value}`)}}}();return c.jsx(d,{w:"100%",borderBottom:"1px solid",borderColor:"primary.10",children:c.jsx(v,{tabs:e,activeTab:a,onChange:o,wrapStyle:{w:"fit-content",overflowX:"auto",scrollbarGutter:"stable",scrollbarWidth:"none"}})})}const A="/v3/sui/dlmm/pool_fee_total",T="/v3/sui/clmm/pool_fee_total";function D(){const{walletErrorString:e,setWalletErrorString:a,poolErrorString:o,setPoolErrorString:s,setPoolSearchLoading:r,poolRecentSearchValues:i,addPoolRecentSearchValue:n,setPoolRecentSearchValues:c,setPoolYieldData:d,setSearchPoolAddress:p,setSearchWalletAddress:S,searchPoolAddress:g,searchWalletAddress:P,poolSearchLoading:m}=w(),{findSearchResult:V}=function(){const{fetchByApi:e}=u(),{suiClient:a}=b(),{setIsDlmm:o}=w();return{findSearchResult:async(s,t)=>{let r;try{const e=await a._client.getObject({id:t,options:{showType:!0,showContent:!0}}),o=e?.data?.content;r=!("moveObject"!==o?.dataType||!o.fields?.bin_manager)}catch(i){try{const a=await e(A,"GET",{wallet_address:s,pool:t});if(a?.pool)return o(!0),{status:"success",data:a};{const a=await e(T,"GET",{wallet_address:s,pool:t});return a?.pool?(o(!1),{status:"success",data:a}):{status:"error",errorMessage:"missing data"}}}catch(n){return{status:"error",errorMessage:"missing data"}}}o(r);try{const a=await e(r?A:T,"GET",{wallet_address:s,pool:t});return a?.pool?{status:"success",data:a}:{status:"error",errorMessage:"missing data"}}catch(i){return null}}}}();l.useEffect(()=>{o&&(g?h(g)?s(""):s("Please enter a valid address"):s(""))},[g,o]),l.useEffect(()=>{e&&(P?h(P)?a(""):a("Please enter a valid address"):a(""))},[P,e]);const f=async(e,o)=>{if(e?h(e)?s(""):s("Please enter a valid address"):s(""),o?h(o)?a(""):a("Please enter a valid address"):a(""),e&&o){if(h(o)&&h(e)){r(!0);try{const a=await V(o,e);if(a&&"success"===a.status){const s=a.data;return d(s),n({searchValue:o,subSearchValue:e}),a}{const e={errorMessage:"missing data"};return d(e),e}}catch(t){const e={errorMessage:"missing data"};return d(e),e}finally{r(!1)}}}};return{searchPoolAddress:g,searchWalletAddress:P,setSearchPoolAddress:p,setSearchWalletAddress:S,handleSearch:f,walletErrorString:e,poolErrorString:o,poolSearchLoading:m,handleValueClick:e=>{S(e?.searchValue),p(e?.subSearchValue??""),f(e?.subSearchValue??"",e?.searchValue);const a=i?.filter(a=>t(a)!==t(e));c([e,...a])}}}function I({walletInputOptions:e,poolInputOptions:a,wrapStyle:o={},enterStyle:s={},isLoading:t,handleEnter:r,onFocus:i,onBlur:n}){const l=t||!e?.value||!a?.value,{isApp:d}=p();return c.jsxs(S,{gap:"4px",w:"full",...o,children:[c.jsx(g,{showEnter:!1,...e,onFocus:i,onBlur:n}),c.jsx(g,{showEnter:!1,...a,onFocus:i,onBlur:n}),c.jsx(P,{onClick:r,cursor:l?"not-allowed":"pointer",bg:{base:l?"primary.60":"primary",lg:"primary.60"},_hover:l?void 0:{bg:"primary"},opacity:l?.6:1,flex:{base:"0 0 32px",lg:"0 0 44px"},h:{base:"32px",lg:"44px"},justify:"center",align:"center",borderRadius:"0px",...s,children:t?c.jsx(m,{w:"16px",h:"16px"}):c.jsx(V,{name:"icon-icon_search",boxSize:d?"12px":"16px",color:"primary_bg",_hover:{fill:"primary_bg"}})})]})}function Y(){const{positionErrorString:e,setPositionErrorString:a,setPositionSearching:o,positionRecentSearchValues:s,addPositionRecentSearchValue:r,setPositionRecentSearchValues:i,setPositionYieldData:n,searchPositionId:c,setSearchPositionId:d,positionSearching:h}=w(),{findSearchResult:p}=function(){const{fetchByApi:e}=u(),{setIsDlmm:a}=w();return{findSearchResult:async o=>{try{const s=await e("/v3/sui/position_yield","GET",{identifier:o});return s?.pool?(a(void 0!==s?.binStep),{status:"success",data:s}):{status:"error",errorMessage:"missing data"}}catch(s){return null}}}}();l.useEffect(()=>{e&&(c?f(c)||R(c)?a(""):a("Please enter a valid address"):a(""))},[c,e]);const S=async e=>{if(e?f(e)||R(e)?a(""):a("Please enter a valid address"):a(""),e){if(f(e)||R(e)){o(!0);try{const a=await p(e);if(a&&"success"===a.status){const o=a.data;return n({...o,positions:o.positions.sort((e,a)=>Number(a.openPositionTimestamp)-Number(e.openPositionTimestamp))}),r({searchValue:e}),a}{const e={errorMessage:"missing data"};return n(e),e}}catch(s){const e={errorMessage:"missing data"};return n(e),e}finally{o(!1)}}}};return{searchPositionId:c,setSearchPositionId:d,handleSearch:S,positionErrorString:e,positionSearching:h,handleValueClick:e=>{d(e?.searchValue),S(e?.searchValue);const a=s?.filter(a=>t(a)!==t(e));i([e,...a])}}}export{I as G,E as H,x as Y,Y as a,w as b,D as u};
