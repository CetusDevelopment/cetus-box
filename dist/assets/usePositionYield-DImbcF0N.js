import{c as e,S as o}from"./v-stack-2OAqoJZH.js";import{f as s,g as a,u as t,r,j as i,B as n}from"./index-CXNoQfxr.js";import{k as l,p as c,m as d,l as u,T as h,j as p,c as S,x as g,S as P,a as m,n as f,o as V}from"./suiClient-BTB45MoP.js";import{u as R,H as v,C as b}from"./Icon-cdQY_hih.js";const{withContext:y}=e({key:"heading"}),E=y("h2");E.displayName="Heading";const w=l()(c(e=>({searchWalletAddress:"",setSearchWalletAddress:o=>{e({searchWalletAddress:o})},searchPoolAddress:"",setSearchPoolAddress:o=>{e({searchPoolAddress:o})},searchPositionId:"",setSearchPositionId:o=>{e({searchPositionId:o})},isDlmm:!1,setIsDlmm:o=>{e({isDlmm:o})},poolYieldData:void 0,setPoolYieldData:o=>{e({poolYieldData:o})},positionYieldData:void 0,setPositionYieldData:o=>{e({positionYieldData:o})},currentPositionData:void 0,setCurrentPositionData:o=>{e({currentPositionData:o})},walletErrorString:void 0,setWalletErrorString:o=>{e({walletErrorString:o})},poolErrorString:void 0,setPoolErrorString:o=>{e({poolErrorString:o})},positionErrorString:void 0,setPositionErrorString:o=>{e({positionErrorString:o})},poolSearchLoading:!1,setPoolSearchLoading:o=>{e({poolSearchLoading:o})},positionSearching:!1,setPositionSearching:o=>{e({positionSearching:o})},poolRecentSearchValues:[],setPoolRecentSearchValues:o=>{e({poolRecentSearchValues:o})},addPoolRecentSearchValue:o=>{e(e=>{const s=u(o);return e.poolRecentSearchValues.some(e=>u(e)===s)?e:{poolRecentSearchValues:[o,...e.poolRecentSearchValues]}})},removePoolRecentSearchValue:o=>{e(e=>({poolRecentSearchValues:e.poolRecentSearchValues.filter(e=>u(e)!==u(o))}))},clearPoolRecentSearchValues:()=>{e({poolRecentSearchValues:[]})},positionRecentSearchValues:[],setPositionRecentSearchValues:o=>{e({positionRecentSearchValues:o})},addPositionRecentSearchValue:o=>{e(e=>{const s=u(o);return e.positionRecentSearchValues.some(e=>u(e)===s)?e:{positionRecentSearchValues:[o,...e.positionRecentSearchValues]}})},removePositionRecentSearchValue:o=>{e(e=>({positionRecentSearchValues:e.positionRecentSearchValues.filter(e=>u(e)!==u(o))}))},clearPositionRecentSearchValues:()=>{e({positionRecentSearchValues:[]})},searchTab:"pool",setSearchTab:o=>{e({searchTab:o})},resetPoolInput:()=>{e({searchWalletAddress:"",searchPoolAddress:"",poolYieldData:void 0,walletErrorString:void 0,poolErrorString:void 0,poolSearchLoading:!1})},resetPositionInput:()=>{e({searchPositionId:"",positionYieldData:void 0,positionErrorString:void 0,positionSearching:!1})},resetInput:()=>{e({searchTab:"pool",searchWalletAddress:"",searchPoolAddress:"",searchPositionId:"",poolYieldData:void 0,positionYieldData:void 0,walletErrorString:void 0,poolErrorString:void 0,positionErrorString:void 0,poolSearchLoading:!1,positionSearching:!1})}}),{name:"useYieldStore",version:1,migrate:(e,o)=>{if(!e)return{poolRecentSearchValues:[],positionRecentSearchValues:[]};if(0===o||!("version"in e)){const o=e.poolRecentSearchValues||[],s=d(o),a=e.positionRecentSearchValues||[],t=d(a);return{...e,poolRecentSearchValues:s,positionRecentSearchValues:t}}return e},partialize:e=>({poolRecentSearchValues:e.poolRecentSearchValues,positionRecentSearchValues:e.positionRecentSearchValues})}));function x(){const{yieldTabs:e,searchTab:o,handleTabChange:l}=function(){const{searchTab:e,setSearchTab:o}=w(),{pathname:i}=s(),n=a(),l=t();return r.useEffect(()=>{i.startsWith("/yield")&&("position"===n?.type?(l("/yield/position"),o("position")):(l("/yield/pool"),o("pool")))},[i,n?.type]),{yieldTabs:[{label:"Pool Yield",value:"pool"},{label:"Position Yield",value:"position"}],searchTab:e,handleTabChange:e=>{o(e.value),i.startsWith("/yield")&&l(`/yield/${e.value}`)}}}();return i.jsx(n,{w:"100%",borderBottom:"1px solid",borderColor:"primary.10",children:i.jsx(h,{tabs:e,activeTab:o,onChange:l,wrapStyle:{w:"fit-content",overflowX:"auto",scrollbarGutter:"stable",scrollbarWidth:"none"}})})}const T="/v3/sui/dlmm/pool_fee_total",A="/v3/sui/clmm/pool_fee_total";function D(){const{walletErrorString:e,setWalletErrorString:o,poolErrorString:s,setPoolErrorString:a,setPoolSearchLoading:t,poolRecentSearchValues:i,addPoolRecentSearchValue:n,setPoolRecentSearchValues:l,setPoolYieldData:c,setSearchPoolAddress:d,setSearchWalletAddress:h,searchPoolAddress:P,searchWalletAddress:m,poolSearchLoading:f}=w(),{findSearchResult:V}=function(){const{fetchByApi:e}=S(),{suiClient:o}=p(),{setIsDlmm:s}=w();return{findSearchResult:async(a,t)=>{let r;try{const e=await o._client.getObject({id:t,options:{showType:!0,showContent:!0}}),s=e?.data?.content;r=!("moveObject"!==s?.dataType||!s.fields?.bin_manager)}catch(i){try{const o=await e(T,"GET",{wallet_address:a,pool:t});if(o?.pool)return s(!0),{status:"success",data:o};{const o=await e(A,"GET",{wallet_address:a,pool:t});return o?.pool?(s(!1),{status:"success",data:o}):{status:"error",errorMessage:"missing data"}}}catch(n){return{status:"error",errorMessage:"missing data"}}}s(r);try{const o=await e(r?T:A,"GET",{wallet_address:a,pool:t});return o?.pool?{status:"success",data:o}:{status:"error",errorMessage:"missing data"}}catch(i){return null}}}}();r.useEffect(()=>{s&&(P?g(P)?a(""):a("Please enter a valid address"):a(""))},[P,s]),r.useEffect(()=>{e&&(m?g(m)?o(""):o("Please enter a valid address"):o(""))},[m,e]);const R=async(e,s)=>{if(e?g(e)?a(""):a("Please enter a valid address"):a(""),s?g(s)?o(""):o("Please enter a valid address"):o(""),e&&s){if(g(s)&&g(e)){t(!0);try{const o=await V(s,e);if(o&&"success"===o.status){const a=o.data;return c(a),n({searchValue:s,subSearchValue:e}),o}{const e={errorMessage:"missing data"};return c(e),e}}catch(r){const e={errorMessage:"missing data"};return c(e),e}finally{t(!1)}}}};return{searchPoolAddress:P,searchWalletAddress:m,setSearchPoolAddress:d,setSearchWalletAddress:h,handleSearch:R,walletErrorString:e,poolErrorString:s,poolSearchLoading:f,handleValueClick:e=>{h(e?.searchValue),d(e?.subSearchValue??""),R(e?.subSearchValue??"",e?.searchValue);const o=i?.filter(o=>u(o)!==u(e));l([e,...o])}}}function I({walletInputOptions:e,poolInputOptions:s,wrapStyle:a={},enterStyle:t={},isLoading:r,handleEnter:n,onFocus:l,onBlur:c}){const d=r||!e?.value||!s?.value,{isApp:u}=R();return i.jsxs(o,{gap:"4px",w:"full",...a,children:[i.jsx(P,{showEnter:!1,...e,onFocus:l,onBlur:c}),i.jsx(P,{showEnter:!1,...s,onFocus:l,onBlur:c}),i.jsx(v,{onClick:n,cursor:d?"not-allowed":"pointer",bg:{base:d?"primary.60":"primary",lg:"primary.60"},_hover:d?void 0:{bg:"primary"},opacity:d?.6:1,flex:{base:"0 0 32px",lg:"0 0 44px"},h:{base:"32px",lg:"44px"},justify:"center",align:"center",borderRadius:"0px",...t,children:r?i.jsx(m,{w:"16px",h:"16px"}):i.jsx(b,{name:"icon-icon_search",boxSize:u?"12px":"16px",color:"primary_bg",_hover:{fill:"primary_bg"}})})]})}function j(){const{positionErrorString:e,setPositionErrorString:o,setPositionSearching:s,positionRecentSearchValues:a,addPositionRecentSearchValue:t,setPositionRecentSearchValues:i,setPositionYieldData:n,searchPositionId:l,setSearchPositionId:c,positionSearching:d}=w(),{findSearchResult:h}=function(){const{fetchByApi:e}=S(),{setIsDlmm:o}=w();return{findSearchResult:async s=>{try{const a=await e("/v3/sui/position_yield","GET",{identifier:s});return a?.pool?(o(void 0!==a?.binStep),{status:"success",data:a}):{status:"error",errorMessage:"missing data"}}catch(a){return null}}}}();r.useEffect(()=>{e&&(l?f(l)||V(l)?o(""):o("Please enter a valid address"):o(""))},[l,e]);const p=async e=>{if(e?f(e)||V(e)?o(""):o("Please enter a valid address"):o(""),e){if(f(e)||V(e)){s(!0);try{const o=await h(e);if(o&&"success"===o.status){const s=o.data;return n({...s,positions:s.positions.sort((e,o)=>Number(o.openPositionTimestamp)-Number(e.openPositionTimestamp))}),t({searchValue:e}),o}{const e={errorMessage:"missing data"};return n(e),e}}catch(a){const e={errorMessage:"missing data"};return n(e),e}finally{s(!1)}}}};return{searchPositionId:l,setSearchPositionId:c,handleSearch:p,positionErrorString:e,positionSearching:d,handleValueClick:e=>{c(e?.searchValue),p(e?.searchValue);const o=a?.filter(o=>u(o)!==u(e));i([e,...o])}}}export{I as G,E as H,x as Y,j as a,w as b,D as u};
