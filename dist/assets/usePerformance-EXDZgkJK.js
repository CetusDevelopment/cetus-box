import{k as e,p as a,m as r,l as t,c as s,u as n,n as c,o as i}from"./suiClient-BTB45MoP.js";import{r as o}from"./index-CXNoQfxr.js";const u=e()(a(e=>({searchValue:"",setSearchValue:a=>{e({searchValue:a})},performanceData:void 0,setPerformanceData:a=>{e({performanceData:a})},positionData:void 0,setPositionData:a=>{e({positionData:a})},inputErrorString:void 0,setInputErrorString:a=>{e({inputErrorString:a})},searchLoading:!1,setSearchLoading:a=>{e({searchLoading:a})},getPositionLoading:!1,setGetPositionLoading:a=>{e({getPositionLoading:a})},recentSearchValues:[],setRecentSearchValues:a=>{e({recentSearchValues:a})},addRecentSearchValue:a=>{e(e=>{const r=t(a);return e.recentSearchValues.some(e=>t(e)===r)?e:{recentSearchValues:[a,...e.recentSearchValues]}})},removeRecentSearchValue:a=>{e(e=>({recentSearchValues:e.recentSearchValues.filter(e=>t(e)!==t(a))}))},clearRecentSearchValues:()=>{e({recentSearchValues:[]})},resetInput:()=>{e({searchValue:"",performanceData:void 0,inputErrorString:void 0,searchLoading:!1})}}),{name:"usePerformanceStore",version:1,migrate:(e,a)=>{if(!e)return{recentSearchValues:[]};if(0===a||!("version"in e)){const a=e.recentSearchValues||[],t=r(a);return{...e,recentSearchValues:t}}return e},partialize:e=>({recentSearchValues:e.recentSearchValues})})),l="/v3/sui/dlmm/position/history";function h(){const{inputErrorString:e,setInputErrorString:a,setSearchLoading:r,addRecentSearchValue:t,setPerformanceData:l,setSearchValue:h,searchValue:d,searchLoading:S,recentSearchValues:V,setRecentSearchValues:f,performanceData:g}=u(),{findSearchResult:m}=function(){const{fetchByApi:e}=s();return{findSearchResult:async a=>{try{const r=await e("/v3/sui/dlmm/position/pnl","GET",{identifier:a});return r?.list&&r.list.length>0?{status:"success",data:r}:{status:"error",errorMessage:"missing data"}}catch(r){return null}}}}(),{addTokens:p}=n();o.useEffect(()=>{if(e&&d){(c(d)||i(d))&&a("")}d||a("")},[e,d]);const v=async e=>{if(e){if(c(e)||i(e)){a(""),r(!0);try{const a=await m(e);if(a&&"success"===a?.status){const r=a.data;l(r),t({searchValue:e});const s=r.list[0]?.coinA,n=r.list[0]?.coinB,c=r.list?.flatMap(e=>e.coinRewards)||[];return p([s,n,...c]),a}{const e={errorMessage:"missing data"};return l(e),e}}catch(s){const e={errorMessage:"missing data"};return l(e),e}finally{r(!1)}}else a("Please enter a valid address")}};return{searchValue:d,setSearchValue:h,handleSearch:v,inputErrorString:e,searchLoading:S,handleValueClick:e=>{h(e.searchValue),v(e.searchValue);const a=V?.filter(a=>a?.searchValue!==e?.searchValue);f([e,...a])},hasPerformanceData:g&&!("errorMessage"in g)}}export{l as D,u as a,h as u};
