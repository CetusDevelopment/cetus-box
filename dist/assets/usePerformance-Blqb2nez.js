import{c as e,p as a,Z as r,b as t,d as s,i as n,e as c}from"./suiClient-flJkUD6N.js";import{e as o}from"./index-ybds6jRs.js";const i=e()(a((e,a)=>({tokenMap:{},addTokens:t=>{const s=a().tokenMap;for(const e of t){const a=r(e.coinType,!1);s[a]||(e.coinType=a,s[a]=e)}e({tokenMap:{...s}})},getToken:e=>a().tokenMap[r(e,!1)]}),{name:"useTokenStore"})),u=e=>`${e.search_value}::${e.sub_search_value??""}`,l=e()(a(e=>({searchValue:"",setSearchValue:a=>{e({searchValue:a})},performanceData:void 0,setPerformanceData:a=>{e({performanceData:a})},positionData:void 0,setPositionData:a=>{e({positionData:a})},inputErrorString:void 0,setInputErrorString:a=>{e({inputErrorString:a})},searchLoading:!1,setSearchLoading:a=>{e({searchLoading:a})},getPositionLoading:!1,setGetPositionLoading:a=>{e({getPositionLoading:a})},recentSearchValues:[],setRecentSearchValues:a=>{e({recentSearchValues:a})},addRecentSearchValue:a=>{e(e=>{const r=u(a);return e.recentSearchValues.some(e=>u(e)===r)?e:{recentSearchValues:[a,...e.recentSearchValues]}})},removeRecentSearchValue:a=>{e(e=>({recentSearchValues:e.recentSearchValues.filter(e=>u(e)!==u(a))}))},clearRecentSearchValues:()=>{e({recentSearchValues:[]})},resetInput:()=>{e({searchValue:"",performanceData:void 0,inputErrorString:void 0,searchLoading:!1})}}),{name:"useTokenStore",partialize:e=>({recentSearchValues:e.recentSearchValues})}));function h(){const{inputErrorString:e,setInputErrorString:a,setSearchLoading:r,addRecentSearchValue:u,setPerformanceData:h,setSearchValue:d,searchValue:S,searchLoading:g,recentSearchValues:f,setRecentSearchValues:p,performanceData:V}=l(),{findSearchResult:m}=function(){const{fetchByApi:e}=t();return{findSearchResult:async a=>{try{const r=await e(s,"GET",{identifier:a});return r&&r?.list&&r.list.length>0?{status:"success",data:r}:{status:"error",error_message:"missing data"}}catch(r){return null}}}}(),{addTokens:v}=i();o.useEffect(()=>{if(e&&S){(n(S)||c(S))&&a("")}S||a("")},[e,S]);const k=async e=>{if(e){if(n(e)||c(e)){a(""),r(!0);try{const a=await m(e);if(a&&"success"===a?.status){const r=a.data;h(r),u({search_value:e});const t=r.list[0]?.coinA,s=r.list[0]?.coinB,n=r.list?.map(e=>e.coinRewards).flat()||[];return v([t,s,...n]),a}{const e={error_message:"missing data"};return h(e),e}}catch(t){const e={error_message:"missing data"};return h(e),e}finally{r(!1)}}else a("Please enter a valid address")}};return{searchValue:S,setSearchValue:d,handleSearch:k,inputErrorString:e,searchLoading:g,handleValueClick:e=>{d(e.search_value),k(e.search_value);const a=f?.filter(a=>a!==e);p([e,...a])},hasPerformanceData:V&&!("error_message"in V)}}export{l as a,i as b,h as u};
