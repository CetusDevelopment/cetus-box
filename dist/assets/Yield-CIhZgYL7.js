import{j as e,e as t,B as s,I as a}from"./index-ybds6jRs.js";import{S as n,e as l,C as o,t as i,b as r,v as p,B as d,h as c,i as x,k as u,f as m,l as g,m as h,J as f,n as b,o as y,p as j,M as S,R as w,s as D,u as k}from"./index-DVzFqQOD.js";import{z as C,a as T}from"./suiClient-flJkUD6N.js";import{a as L,H as U,u as Y,G as A}from"./useYield-D9HHq1YM.js";import{V as _,T as z,S as B}from"./v-stack-BY_1ISyr.js";import{H as v,u as F}from"./useSize-Dvc3rk6B.js";import"./toaster-D3S-FEJL.js";import"./button-CYzPHx_C.js";function R({totalYield:t,feeYieldList:s,miningYieldList:a,farmingYieldList:o}){const{searchLoading:i}=L();return e.jsxs(_,{p:{base:"16px",lg:"20px"},gap:{base:"8px",lg:"12px"},w:{base:"100%",lg:"380px"},minW:{base:"100%",lg:"380px"},bg:"input_bg",border:"1px solid",borderColor:"primary.10",children:[e.jsxs(v,{w:"100%",justify:"space-between",children:[e.jsx(U,{fontSize:"14px",color:"primary_text",fontWeight:"500",children:"Total Yield"}),i?e.jsx(n,{loading:i,ml:"12px",noOfLines:1,rootProps:{h:"14px",flex:"0 0 100px"}}):e.jsx(z,{fontSize:"14px",color:"primary",fontWeight:"500",children:t&&Number(t)>0?`+$${l(t)}`:"$0"})]}),e.jsx($,{title:"Total fees you earn",yieldList:s,loading:i}),a&&a?.length>0&&e.jsx($,{title:"Total mining rewards you earn",yieldList:a,loading:i}),o&&o?.length>0&&e.jsx($,{title:"Total farming rewards you earn",yieldList:o,loading:i}),e.jsx(z,{fontSize:"12px",lineHeight:"16px",color:"second_text",children:"For closed positions, only those closed within the past 3 months are tracked."})]})}const $=({title:t,yieldList:s,loading:a})=>e.jsxs(_,{w:"100%",p:{base:"8px",lg:"16px"},align:"flex-start",bg:"secondary_background.10",children:[e.jsx(z,{fontSize:"12px",color:"second_text",children:t}),a?(s&&0!==s?.length?s:[1,2])?.map((t,s)=>e.jsx(N,{},"object"==typeof t?t?.token?.coinType:s)):s?.map(t=>e.jsxs(v,{gap:"4px",children:[e.jsx(o,{src:t?.token?.logoURL,size:"16px"}),e.jsx(z,{fontSize:"12px",color:"primary_text",children:`${l(t?.amount||0)} ${i(t?.token?.symbol)}`}),e.jsxs(z,{fontSize:"12px",color:"second_text",children:["(~$",l(t?.amountUsd),")"]})]},t?.token?.coinType))]}),N=()=>e.jsxs(v,{gap:"4px",children:[e.jsx(r,{size:"16px"}),e.jsx(n,{noOfLines:1,h:"12px",w:"60px"}),e.jsx(n,{noOfLines:1,h:"12px",w:"60px"})]});const E=["Total Yield Token","BaseFee & BinStep"],I=["Total Yield Token","Fee Tier"];function W({totalYield:n,feeYieldList:o,miningYieldList:r,farmingYieldList:S}){const{yieldData:w,isDlmm:D,searchLoading:k}=L(),T=w,U=D?"dlmm":"clmm",[Y,A]=t.useState([]);t.useEffect(()=>{A("dlmm"===U?E:I)},[U]);const[B,F]=t.useState(),R=Y.includes("Total Yield Token"),$=Y.includes("Fee Tier"),N=Y.includes("BaseFee & BinStep"),{displayTokenA:W,displayTokenB:M,yieldList:V}=function({feeYieldList:e,miningYieldList:s}){const{yieldData:a}=L(),n=a;return{displayTokenA:n?.showReverse?n?.coinB:n?.coinA,displayTokenB:n?.showReverse?n?.coinA:n?.coinB,yieldList:t.useMemo(()=>{const t=new Map;return e.forEach(e=>t.set(e.token?.coinType,{token:e?.token,amount:e?.amount,amountUsd:e?.amountUsd})),s&&s?.length>0&&s.forEach(e=>{t.has(e.token?.coinType)||t.set(e.token?.coinType,{token:e?.token,amount:e?.amount,amountUsd:e?.amountUsd});const s=t.get(e.token?.coinType)?.amount,a=t.get(e.token?.coinType)?.amountUsd;t.set(e.token?.coinType,{token:e?.token,amount:C(s).plus(e?.amount).toNumber(),amountUsd:C(a).plus(e?.amountUsd).toNumber()})}),Array.from(t.values())},[e,s])}}({feeYieldList:o,miningYieldList:r}),H=p(C(n).toNumber()),O=[`/images/share/${H}_1.png`,`/images/share/${H}_2.png`,`/images/share/${H}_3.png`];return t.useEffect(()=>{F(`/images/share/${H}_1.png`)},[H,T]),e.jsx(d,{p:{base:"0px",lg:"22px 20px 20px"},border:{base:"none",lg:"1px solid"},flex:"1",children:e.jsxs(_,{gap:"0px",w:"100%",children:[e.jsx(c,{w:"100%",h:{base:"auto",lg:"280px"},aspectRatio:"16 / 9",loading:k,children:e.jsxs(_,{w:"100%",p:{base:"8px",lg:"20px"},minH:{base:"auto",lg:"280px"},aspectRatio:"16 / 9",alignItems:"start",gap:"0px",justifyContent:"start",bg:{base:`center / contain no-repeat url(${B})`,lg:`center / 100% 100% no-repeat url(${B})`},pos:"relative",zIndex:"-11",id:"yield_card",children:[e.jsx(s,{zIndex:"-10",pos:"absolute",top:"0",left:"0",w:"100%",h:"100%",bg:"center / 100% 100% no-repeat url('/images/share/icon_mask.png')"}),e.jsxs(v,{w:"100%",justifyContent:"space-between",mb:{base:"6px",lg:"32px"},children:[e.jsxs(v,{justifyContent:"start",gap:"8px",children:[e.jsx(a,{src:"/images/icon_logo.png",w:"20px",h:"23px"}),e.jsxs(z,{color:"primary_text",fontSize:"14px",textTransform:"uppercase",fontWeight:"500",children:["CETUS ",U]})]}),e.jsxs(_,{alignItems:"end",justifyContent:"start",gap:"0px",children:[e.jsx(z,{color:"primary_text",fontSize:"10px",lineHeight:"15px",children:"Snapshot on"}),e.jsx(z,{color:"primary_text",fontSize:"10px",lineHeight:"15px",children:x()})]})]}),e.jsx(u,{tokenA:W,tokenB:M,symbolStyle:{fontSize:"24px",ml:"8px",fontWeight:"600"}}),e.jsx(z,{fontSize:"12px",color:"card_text",mt:{base:"20px",lg:"28px"},fontWeight:"500",children:"Total Yield (USD)"}),e.jsx(z,{fontSize:{base:"32px",lg:"46px"},color:"primary",mt:{base:"8px",lg:"12px"},fontWeight:"700",children:m(n)}),e.jsxs(v,{w:"100%",justifyContent:"space-between",flexWrap:"wrap",position:"absolute",bottom:"0",left:"0",p:{base:"0 8px 8px",lg:"0 20px 20px"},children:[R&&V?.map(t=>e.jsx(g,{label:`Total ${i(t.token?.symbol)}`,value:l(t?.amount),wrapStyle:{justifyContent:"center",w:"unset"},labelStyle:{fontSize:{base:"10px",lg:"12px"}},valueStyle:{fontSize:{base:"10px",lg:"12px"}},skeletonStyle:{h:{base:"10px",lg:"20px"},w:{base:"36px",lg:"48px"}}},t.token?.coinType)),$&&e.jsx(g,{label:"Fee Tier",value:h(C(T?.feeRate).div(f).toNumber()),wrapStyle:{justifyContent:"center",w:"unset"},labelStyle:{fontSize:{base:"10px",lg:"12px"}},valueStyle:{fontSize:{base:"10px",lg:"12px"}},skeletonStyle:{h:{base:"10px",lg:"20px"},w:{base:"36px",lg:"48px"}}}),N&&e.jsx(g,{label:"BaseFee & BinStep",value:void 0!==T?.baseFeeRate?`${h(C(T?.baseFeeRate).mul(100).toNumber())} | ${T?.binStep??"--"}bps`:"--",wrapStyle:{justifyContent:"center",w:"unset"},labelStyle:{fontSize:{base:"10px",lg:"12px"}},valueStyle:{fontSize:{base:"10px",lg:"12px"}},skeletonStyle:{h:{base:"10px",lg:"20px"},w:{base:"36px",lg:"48px"}}})]})]})}),e.jsxs(_,{w:"100%",mt:"20px",gap:"16px",children:[e.jsx(b,{data:"dlmm"===U?E:I,selected:Y,handleSelectedChange:e=>A(e)}),B&&e.jsx(y,{imageUrls:O,currImageUrl:B,handleSelectedChange:F,loading:k})]}),e.jsx(j,{style:{mt:"28px"},card_id:"yield_card",filename:`${U}_${W?.symbol}_${M?.symbol}`})]})})}function M(){const{searchLoading:t,yieldData:s,isDlmm:a}=L(),n=s,l=n?.showReverse?n.coinB:n.coinA,o=n?.showReverse?n.coinA:n.coinB;return t?e.jsx(V,{}):e.jsx(u,{tokenA:l,tokenB:o,feeDisplay:h(a?C(n?.baseFeeRate).mul(100).toNumber():C(n?.feeRate).div(f).toNumber()),bps:n?.binStep})}function V(){return e.jsx(u,{tokenA:S.SUI,tokenB:S.USDC,feeDisplay:"0.1%",bps:25,isLoading:!0})}function H(){const{totalYield:t,feeYieldList:s,miningYieldList:a}=function(){const{yieldData:e}=L(),t=e,s=t?.positions?.reduce((e,t)=>e.plus(t?.currentData?.unclaimedFeeAUSD??0).plus(t?.currentData?.unclaimedFeeBUSD??0).plus(t?.currentData?.unclaimedRewardsUSD?.reduce((e,t)=>e.plus(t?.uUnClaimedUSD),C(0))??0).plus(t?.historicalData?.totalClaimedFeeAUSD).plus(t?.historicalData?.totalClaimedFeeBUSD).plus(t?.historicalData?.totalClaimedRewards?.reduce((e,t)=>e.plus(t?.rewardUSD),C(0))),C(0)).toNumber(),a=[{token:t?.coinA,amount:t?.positions?.reduce((e,t)=>e.plus(t?.historicalData?.totalClaimedFeeAAmount)?.plus(t?.currentData?.unclaimedFeeAAmount??0),C(0)).toNumber(),amountUsd:t?.positions?.reduce((e,t)=>e.plus(t?.historicalData?.totalClaimedFeeAUSD)?.plus(t?.currentData?.unclaimedFeeAUSD??0),C(0)).toNumber()},{token:t?.coinB,amount:t?.positions?.reduce((e,t)=>e.plus(t?.historicalData?.totalClaimedFeeBAmount)?.plus(t?.currentData?.unclaimedFeeBAmount??0),C(0)).toNumber(),amountUsd:t?.positions?.reduce((e,t)=>e.plus(t?.historicalData?.totalClaimedFeeBUSD)?.plus(t?.currentData?.unclaimedFeeBUSD??0),C(0)).toNumber()}],n=t?.coinRewards?.map(e=>{const s=t?.positions?.reduce((t,s)=>t.plus(s?.historicalData?.totalClaimedRewards?.filter(t=>t?.CoinType===e?.coinType)?.reduce((e,t)=>e.plus(t?.rewardAmount),C(0)))?.plus(s?.currentData?.unclaimedRewardsUSD?.filter(t=>t?.CoinType===e?.coinType)?.reduce((e,t)=>e.plus(t?.unClaimedAmount),C(0))??0),C(0)).toNumber(),a=t?.positions?.reduce((t,s)=>t.plus(s?.historicalData?.totalClaimedRewards?.filter(t=>t?.CoinType===e?.coinType)?.reduce((e,t)=>e.plus(t?.rewardUSD),C(0)))?.plus(s?.currentData?.unclaimedRewardsUSD?.filter(t=>t?.CoinType===e?.coinType)?.reduce((e,t)=>e?.plus(t?.uUnClaimedUSD),C(0))??0),C(0)).toNumber();return s&&C(s).gt(0)?{token:e,amount:s,amountUsd:a}:null}).filter(e=>null!==e);return{totalYield:s,feeYieldList:a,miningYieldList:n}}();return e.jsxs(_,{gap:{base:"12px",lg:"28px"},mt:{base:"4px",lg:"16px"},align:"flex-start",w:"100%",pt:{base:"8px",lg:"28px"},borderTop:"1px solid",borderColor:"primary.10",children:[e.jsx(M,{}),e.jsxs(B,{w:"100%",gap:{base:"16px",lg:"20px"},justify:"space-between",align:"flex-start",flexDir:{base:"column",lg:"row"},children:[e.jsx(R,{totalYield:t,feeYieldList:s,miningYieldList:a}),e.jsx(W,{totalYield:t,feeYieldList:s,miningYieldList:a})]})]})}function O(){const{searchPoolAddress:s,searchWalletAddress:a,setSearchPoolAddress:n,setSearchWalletAddress:l,handleSearch:o,walletErrorString:i,poolErrorString:r,handleValueClick:p,searchLoading:d}=Y(),{yieldData:c,recentSearchValues:x,clearRecentSearchValues:u,removeRecentSearchValue:m,resetInput:g}=L();t.useEffect(()=>()=>{g()},[g]);const h=()=>o(s,a),f=c&&!("error_message"in c),{isApp:b}=F();return e.jsxs(_,{gap:"12px",w:{base:"100%",lg:f?"940px":"700px"},mt:{base:f?"20px":"80px",lg:f?"20px":"147px"},align:f?"flex-start":"center",children:[e.jsx(z,{color:"primary_text",fontSize:"20px",fontWeight:"500",children:"Yield"}),e.jsx(z,{mb:{base:"0px",lg:"8px"},color:"second_text",fontSize:"12px",lineHeight:"20px",children:"View your total yield from any Cetus CLMM or DLMM pool, including claimed and unclaimed rewards. Enter both your wallet and pool address to generate a shareable yield card."}),e.jsx(A,{walletInputOptions:{value:a,onEnter:h,onInputChange:l,errorSting:i,placeholder:"Wallet address here…"},poolInputOptions:{value:s,onEnter:h,onInputChange:n,errorSting:r,placeholder:"CLMM / DLMM pool address here…"},isLoading:d,handleEnter:h,wrapStyle:{flexDir:{base:"column",lg:"row"},gap:{base:"8px",lg:"14px"}}}),e.jsx(w,{style:{mt:f?"0px":"16px"},direction:b?"column":f?"row":"column",values:x,handleClearAll:u,handleValueClick:p,handleDeleteValue:m}),d&&e.jsx(D,{w:"100%",h:"138px",children:e.jsx(T,{w:"16px",h:"16px",color:"primary",_hover:{"& svg":{fill:"primary"}}})}),f&&!d&&e.jsx(H,{}),c&&"error_message"in c&&!d&&e.jsx(k,{style:{mt:"16px"},type:"fee"})]})}export{O as default};
