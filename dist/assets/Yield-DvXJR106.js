import{j as e,r as t,I as s}from"./index-DjgbpSHW.js";import{S as a,C as l,a as n,b as o,J as i,B as r,c as p,d,e as x,f as c,h as u,M as m,R as g,i as h,j as y}from"./index-Bt0fWL0i.js";import{z as f,g as b,t as S,h as j,f as w,j as D,s as T,a as k}from"./suiClient-DkjIMpb0.js";import{a as C,H as L,u as z,G as U}from"./useYield-CLmhRJvX.js";import{V as Y,T as _,S as v}from"./v-stack-wpQ1XMEo.js";import{H as A,u as F}from"./useSize-By1lzbFp.js";import"./toaster-Crw-epuv.js";import"./button-BeJ_08Mj.js";function B({totalYield:t,feeYieldList:s,miningYieldList:l,farmingYieldList:n}){const{searchLoading:o}=C();return e.jsxs(Y,{p:{base:"16px",lg:"20px"},gap:{base:"8px",lg:"12px"},w:{base:"100%",lg:"380px"},minW:{base:"100%",lg:"380px"},bg:"input_bg",border:"1px solid",borderColor:"primary.10",children:[e.jsxs(A,{w:"100%",justify:"space-between",children:[e.jsx(L,{fontSize:"14px",color:"primary_text",fontWeight:"500",children:"Total Yield"}),o?e.jsx(a,{loading:o,ml:"12px",noOfLines:1,rootProps:{h:"14px",flex:"0 0 100px"}}):e.jsx(_,{fontSize:"14px",color:"primary",fontWeight:"500",children:t&&Number(t)>0?`+$${b(t)}`:"$0"})]}),e.jsx($,{title:"Total fees you earn",yieldList:s,loading:o}),l&&l?.length>0&&e.jsx($,{title:"Total mining rewards you earn",yieldList:l,loading:o}),n&&n?.length>0&&e.jsx($,{title:"Total farming rewards you earn",yieldList:n,loading:o}),e.jsx(_,{fontSize:"12px",lineHeight:"16px",color:"second_text",children:"For closed positions, only those closed within the past 3 months are tracked."})]})}const $=({title:t,yieldList:s,loading:a})=>e.jsxs(Y,{w:"100%",p:{base:"8px",lg:"16px"},align:"flex-start",bg:"secondary_background.10",children:[e.jsx(_,{fontSize:"12px",color:"second_text",children:t}),a?(s&&0!==s?.length?s:[1,2])?.map((t,s)=>e.jsx(R,{},"object"==typeof t?t?.token?.coinType:s)):s?.map(t=>e.jsxs(A,{gap:"4px",children:[e.jsx(l,{src:t?.token?.logoURL,size:"16px"}),e.jsx(_,{fontSize:"12px",color:"primary_text",children:`${b(t?.amount||0)} ${S(t?.token?.symbol)}`}),e.jsxs(_,{fontSize:"12px",color:"second_text",children:["(~$",b(t?.amountUsd),")"]})]},t?.token?.coinType))]}),R=()=>e.jsxs(A,{gap:"4px",children:[e.jsx(n,{size:"16px"}),e.jsx(a,{noOfLines:1,h:"12px",w:"60px"}),e.jsx(a,{noOfLines:1,h:"12px",w:"60px"})]});function I({bgImageUrl:t,poolType:a,displayTokenA:l,displayTokenB:n,totalYield:r,yieldList:p,showBaseFee:d,showFeeTier:x,showTokenYield:c,yieldData:u}){return e.jsxs(Y,{w:"1280px",p:"50px",h:"720px",aspectRatio:"16 / 9",alignItems:"start",gap:"0px",justifyContent:"start",zIndex:"-11",id:"yield_card",pos:"absolute",left:"-9999px",top:"-9999px",children:[e.jsx(s,{pos:"absolute",src:t,w:"100%",h:"100%",zIndex:"-11",top:"0",left:"0"}),e.jsxs(A,{w:"100%",justifyContent:"space-between",mb:"52px",children:[e.jsx(s,{h:"58px",w:"auto",src:`/images/share/${a}_logo.png`}),e.jsxs(Y,{alignItems:"end",justifyContent:"start",gap:"0px",children:[e.jsx(_,{color:"primary_text",fontSize:"26px",letterSpacing:"2",lineHeight:"38px",children:"Snapshot by cetusbox.zone"}),e.jsx(_,{color:"primary_text",fontSize:"26px",letterSpacing:"2",lineHeight:"38px",children:j()})]})]}),e.jsxs(_,{fontSize:"84px",color:"primary_text",fontWeight:"500",letterSpacing:"4",children:[S(l?.symbol),"-",S(n?.symbol)]}),e.jsx(_,{fontSize:"33px",color:"card_text",mt:"58px",fontWeight:"500",letterSpacing:"2",children:"Total Yield (USD)"}),e.jsx(_,{color:"primary",fontWeight:"700",fontSize:"118px",letterSpacing:"7",mt:"20px",children:w(r)}),e.jsxs(A,{w:"100%",justifyContent:"space-between",flexWrap:"wrap",position:"absolute",bottom:"0",left:"0",p:"0 50px 50px",gap:"24px",children:[c&&p?.map(t=>e.jsx(o,{label:`Total ${S(t.token?.symbol)}`,value:b(t?.amount),wrapStyle:{justifyContent:"center",w:"unset"},labelStyle:{fontSize:"33px",letterSpacing:"2"},valueStyle:{fontSize:"33px",letterSpacing:"2"},skeletonStyle:{h:"33px",w:"200px"}},t.token?.coinType)),x&&e.jsx(o,{label:"Fee Tier",value:D(f(u?.feeRate).div(i).toNumber()),wrapStyle:{justifyContent:"center",w:"unset"},labelStyle:{fontSize:"33px",letterSpacing:"2"},valueStyle:{fontSize:"33px",letterSpacing:"2"},skeletonStyle:{h:"33px",w:"200px"}}),d&&e.jsx(o,{label:"BaseFee & BinStep",value:void 0!==u?.baseFeeRate?`${D(f(u?.baseFeeRate).mul(100).toNumber())} | ${u?.binStep??"--"}bps`:"--",wrapStyle:{justifyContent:"center",w:"unset"},labelStyle:{fontSize:"33px",letterSpacing:"2"},valueStyle:{fontSize:"33px",letterSpacing:"2"},skeletonStyle:{h:"33px",w:"200px"}})]})]})}const N=["Total Yield Token","BaseFee & BinStep"],W=["Total Yield Token","Fee Tier"];function E({totalYield:a,feeYieldList:l,miningYieldList:n,farmingYieldList:u}){const{yieldData:m,isDlmm:g,searchLoading:h}=C(),y=m,k=g?"dlmm":"clmm",[L,z]=t.useState([]);t.useEffect(()=>{z("dlmm"===k?N:W)},[k]);const[U,v]=t.useState(),F=L.includes("Total Yield Token"),B=L.includes("Fee Tier"),$=L.includes("BaseFee & BinStep"),{displayTokenA:R,displayTokenB:E,yieldList:M}=function({feeYieldList:e,miningYieldList:s}){const{yieldData:a}=C(),l=a;return{displayTokenA:l?.showReverse?l?.coinB:l?.coinA,displayTokenB:l?.showReverse?l?.coinA:l?.coinB,yieldList:t.useMemo(()=>{const t=new Map;return e.forEach(e=>t.set(e.token?.coinType,{token:e?.token,amount:e?.amount,amountUsd:e?.amountUsd})),s&&s?.length>0&&s.forEach(e=>{t.has(e.token?.coinType)||t.set(e.token?.coinType,{token:e?.token,amount:e?.amount,amountUsd:e?.amountUsd});const s=t.get(e.token?.coinType)?.amount,a=t.get(e.token?.coinType)?.amountUsd;t.set(e.token?.coinType,{token:e?.token,amount:f(s).plus(e?.amount).toNumber(),amountUsd:f(a).plus(e?.amountUsd).toNumber()})}),Array.from(t.values())},[e,s])}}({feeYieldList:l,miningYieldList:n}),H=T(f(a).toNumber()),V=["flat","strong_loss"].includes(H)?[`/images/share/${H}_1.png`,`/images/share/${H}_2.png`,`/images/share/${H}_3.png`,`/images/share/${H}_4.png`]:[`/images/share/${H}_1.png`,`/images/share/${H}_2.png`,`/images/share/${H}_3.png`];return t.useEffect(()=>{v(`/images/share/${H}_1.png`)},[H,y]),e.jsxs(r,{p:{base:"0px",lg:"22px 20px 20px"},border:"1px solid",borderColor:{base:"transparent",lg:"primary.10"},flex:"1",children:[e.jsxs(Y,{gap:"0px",w:"100%",children:[e.jsx(p,{w:"100%",h:{base:"auto",lg:"280px"},aspectRatio:"16 / 9",loading:h,children:e.jsxs(Y,{w:"100%",p:{base:"8px",lg:"20px"},minH:{base:"auto",lg:"280px"},aspectRatio:"16 / 9",alignItems:"start",gap:"0px",justifyContent:"start",bg:{base:`center / contain no-repeat url(${U})`,lg:`center / 100% 100% no-repeat url(${U})`},pos:"relative",zIndex:"-11",children:[e.jsxs(A,{w:"100%",justifyContent:"space-between",mb:{base:"6px",lg:"32px"},children:[e.jsx(A,{justifyContent:"start",gap:"8px",children:e.jsx(s,{h:"23px",w:"auto",src:`/images/share/${k}_logo.png`})}),e.jsxs(Y,{alignItems:"end",justifyContent:"start",gap:"0px",children:[e.jsx(_,{color:"primary_text",fontSize:"10px",lineHeight:"15px",children:"Snapshot by cetusbox.zone"}),e.jsx(_,{color:"primary_text",fontSize:"10px",lineHeight:"15px",children:j()})]})]}),e.jsxs(_,{fontSize:"24px",color:"primary_text",fontWeight:"500",letterSpacing:"1",children:[S(R?.symbol),"-",S(E?.symbol)]}),e.jsx(_,{fontSize:"12px",color:"card_text",mt:{base:"20px",lg:"28px"},fontWeight:"500",children:"Total Yield (USD)"}),e.jsx(_,{fontSize:{base:"32px",lg:"46px"},color:"primary",mt:{base:"8px",lg:"12px"},fontWeight:"700",children:w(a)}),e.jsxs(A,{w:"100%",justifyContent:"space-between",flexWrap:"wrap",position:"absolute",bottom:"0",left:"0",p:{base:"0 8px 8px",lg:"0 20px 20px"},children:[F&&M?.map(t=>e.jsx(o,{label:`Total ${S(t.token?.symbol)}`,value:b(t?.amount),wrapStyle:{justifyContent:"center",w:"unset"},labelStyle:{fontSize:{base:"10px",lg:"12px"}},valueStyle:{fontSize:{base:"10px",lg:"12px"}},skeletonStyle:{h:{base:"10px",lg:"20px"},w:{base:"36px",lg:"48px"}}},t.token?.coinType)),B&&e.jsx(o,{label:"Fee Tier",value:D(f(y?.feeRate).div(i).toNumber()),wrapStyle:{justifyContent:"center",w:"unset"},labelStyle:{fontSize:{base:"10px",lg:"12px"}},valueStyle:{fontSize:{base:"10px",lg:"12px"}},skeletonStyle:{h:{base:"10px",lg:"20px"},w:{base:"36px",lg:"48px"}}}),$&&e.jsx(o,{label:"BaseFee & BinStep",value:void 0!==y?.baseFeeRate?`${D(f(y?.baseFeeRate).mul(100).toNumber())} | ${y?.binStep??"--"}bps`:"--",wrapStyle:{justifyContent:"center",w:"unset"},labelStyle:{fontSize:{base:"10px",lg:"12px"}},valueStyle:{fontSize:{base:"10px",lg:"12px"}},skeletonStyle:{h:{base:"10px",lg:"20px"},w:{base:"36px",lg:"48px"}}})]})]})}),e.jsxs(Y,{w:"100%",mt:"20px",gap:"16px",children:[e.jsx(d,{data:"dlmm"===k?N:W,selected:L,handleSelectedChange:e=>z(e)}),U&&e.jsx(x,{imageUrls:V,currImageUrl:U,handleSelectedChange:v,loading:h})]}),e.jsx(c,{style:{mt:"28px"},card_id:"yield_card",filename:`${k}_${R?.symbol}_${E?.symbol}`})]}),e.jsx(I,{bgImageUrl:U,poolType:k,displayTokenA:R,displayTokenB:E,totalYield:a,yieldList:M,showBaseFee:$,showFeeTier:B,showTokenYield:F,yieldData:y})]})}function M(){const{searchLoading:t,yieldData:s,isDlmm:a}=C(),l=s,n=l?.showReverse?l.coinB:l.coinA,o=l?.showReverse?l.coinA:l.coinB;return t?e.jsx(H,{}):e.jsx(u,{tokenA:n,tokenB:o,feeDisplay:D(a?f(l?.baseFeeRate).mul(100).toNumber():f(l?.feeRate).div(i).toNumber()),bps:l?.binStep})}function H(){return e.jsx(u,{tokenA:m.SUI,tokenB:m.USDC,feeDisplay:"0.1%",bps:25,isLoading:!0})}function V(){const{totalYield:t,feeYieldList:s,miningYieldList:a}=function(){const{yieldData:e}=C(),t=e,s=t?.positions?.reduce((e,t)=>e.plus(t?.currentData?.unclaimedFeeAUSD??0).plus(t?.currentData?.unclaimedFeeBUSD??0).plus(t?.currentData?.unclaimedRewardsUSD?.reduce((e,t)=>e.plus(t?.uUnClaimedUSD),f(0))??0).plus(t?.historicalData?.totalClaimedFeeAUSD).plus(t?.historicalData?.totalClaimedFeeBUSD).plus(t?.historicalData?.totalClaimedRewards?.reduce((e,t)=>e.plus(t?.rewardUSD),f(0))),f(0)).toNumber(),a=[{token:t?.coinA,amount:t?.positions?.reduce((e,t)=>e.plus(t?.historicalData?.totalClaimedFeeAAmount)?.plus(t?.currentData?.unclaimedFeeAAmount??0),f(0)).toNumber(),amountUsd:t?.positions?.reduce((e,t)=>e.plus(t?.historicalData?.totalClaimedFeeAUSD)?.plus(t?.currentData?.unclaimedFeeAUSD??0),f(0)).toNumber()},{token:t?.coinB,amount:t?.positions?.reduce((e,t)=>e.plus(t?.historicalData?.totalClaimedFeeBAmount)?.plus(t?.currentData?.unclaimedFeeBAmount??0),f(0)).toNumber(),amountUsd:t?.positions?.reduce((e,t)=>e.plus(t?.historicalData?.totalClaimedFeeBUSD)?.plus(t?.currentData?.unclaimedFeeBUSD??0),f(0)).toNumber()}],l=t?.coinRewards?.map(e=>{const s=t?.positions?.reduce((t,s)=>t.plus(s?.historicalData?.totalClaimedRewards?.filter(t=>t?.CoinType===e?.coinType)?.reduce((e,t)=>e.plus(t?.rewardAmount),f(0)))?.plus(s?.currentData?.unclaimedRewardsUSD?.filter(t=>t?.CoinType===e?.coinType)?.reduce((e,t)=>e.plus(t?.unClaimedAmount),f(0))??0),f(0)).toNumber(),a=t?.positions?.reduce((t,s)=>t.plus(s?.historicalData?.totalClaimedRewards?.filter(t=>t?.CoinType===e?.coinType)?.reduce((e,t)=>e.plus(t?.rewardUSD),f(0)))?.plus(s?.currentData?.unclaimedRewardsUSD?.filter(t=>t?.CoinType===e?.coinType)?.reduce((e,t)=>e?.plus(t?.uUnClaimedUSD),f(0))??0),f(0)).toNumber();return s&&f(s).gt(0)?{token:e,amount:s,amountUsd:a}:null}).filter(e=>null!==e);return{totalYield:s,feeYieldList:a,miningYieldList:l}}();return e.jsxs(Y,{gap:{base:"12px",lg:"28px"},mt:{base:"4px",lg:"16px"},align:"flex-start",w:"100%",pt:{base:"8px",lg:"28px"},borderTop:"1px solid",borderColor:"primary.10",children:[e.jsx(M,{}),e.jsxs(v,{w:"100%",gap:{base:"16px",lg:"20px"},justify:"space-between",align:"flex-start",flexDir:{base:"column",lg:"row"},children:[e.jsx(B,{totalYield:t,feeYieldList:s,miningYieldList:a}),e.jsx(E,{totalYield:t,feeYieldList:s,miningYieldList:a})]})]})}function O(){const{searchPoolAddress:s,searchWalletAddress:a,setSearchPoolAddress:l,setSearchWalletAddress:n,handleSearch:o,walletErrorString:i,poolErrorString:r,handleValueClick:p,searchLoading:d}=z(),{yieldData:x,recentSearchValues:c,clearRecentSearchValues:u,removeRecentSearchValue:m,resetInput:f}=C();t.useEffect(()=>()=>{f()},[f]);const b=()=>o(s,a),S=x&&!("error_message"in x),{isApp:j}=F();return e.jsxs(Y,{gap:"12px",w:{base:"100%",lg:S?"940px":"700px"},mt:{base:S?"20px":"80px",lg:S?"20px":"147px"},align:S?"flex-start":"center",children:[e.jsx(_,{color:"primary_text",fontSize:"20px",fontWeight:"500",children:"Yield"}),e.jsx(_,{mb:{base:"0px",lg:"8px"},color:"second_text",fontSize:"12px",lineHeight:"20px",children:"View your total yield from any Cetus CLMM or DLMM pool, including claimed and unclaimed rewards. Enter both your wallet and pool address to generate a shareable yield card."}),e.jsx(U,{walletInputOptions:{value:a,onEnter:b,onInputChange:n,errorSting:i,placeholder:"Wallet address here…"},poolInputOptions:{value:s,onEnter:b,onInputChange:l,errorSting:r,placeholder:"CLMM / DLMM pool address here…"},isLoading:d,handleEnter:b,wrapStyle:{flexDir:{base:"column",lg:"row"},gap:{base:"8px",lg:"14px"}}}),e.jsx(g,{style:{mt:S?"0px":"16px"},direction:j?"column":S?"row":"column",values:c,handleClearAll:u,handleValueClick:p,handleDeleteValue:m}),d&&e.jsx(h,{w:"100%",h:"138px",children:e.jsx(k,{w:"16px",h:"16px",color:"primary",_hover:{"& svg":{fill:"primary"}}})}),S&&!d&&e.jsx(V,{}),x&&"error_message"in x&&!d&&e.jsx(y,{style:{mt:"16px"},type:"fee"})]})}export{O as default};
