import{c as e,S as s}from"./v-stack-B6LixqQq.js";import{f as a,g as o,u as r,r as t,j as i,B as n}from"./index-CBgVo8fP.js";import{l,p as c,m as d,T as u,S as h,a as p,k as S,c as g,v as P,C as m,w as v,P as f,o as b,q as y}from"./suiClient-wWAkg6op.js";import{u as R,H as V,C as E}from"./useSize-v-qm-NHg.js";const{withContext:w}=e({key:"heading"}),x=w("h2");x.displayName="Heading";const T=l()(c(e=>({searchWalletAddress:"",setSearchWalletAddress:s=>{e({searchWalletAddress:s})},searchPoolAddress:"",setSearchPoolAddress:s=>{e({searchPoolAddress:s})},searchPositionId:"",setSearchPositionId:s=>{e({searchPositionId:s})},isDlmm:!1,setIsDlmm:s=>{e({isDlmm:s})},poolYieldData:void 0,setPoolYieldData:s=>{e({poolYieldData:s})},positionYieldData:void 0,setPositionYieldData:s=>{e({positionYieldData:s})},currentPositionData:void 0,setCurrentPositionData:s=>{e({currentPositionData:s})},walletErrorString:void 0,setWalletErrorString:s=>{e({walletErrorString:s})},poolErrorString:void 0,setPoolErrorString:s=>{e({poolErrorString:s})},positionErrorString:void 0,setPositionErrorString:s=>{e({positionErrorString:s})},poolSearchLoading:!1,setPoolSearchLoading:s=>{e({poolSearchLoading:s})},positionSearching:!1,setPositionSearching:s=>{e({positionSearching:s})},poolRecentSearchValues:[],setPoolRecentSearchValues:s=>{e({poolRecentSearchValues:s})},addPoolRecentSearchValue:s=>{e(e=>{const a=d(s);return e.poolRecentSearchValues.some(e=>d(e)===a)?e:{poolRecentSearchValues:[s,...e.poolRecentSearchValues]}})},removePoolRecentSearchValue:s=>{e(e=>({poolRecentSearchValues:e.poolRecentSearchValues.filter(e=>d(e)!==d(s))}))},clearPoolRecentSearchValues:()=>{e({poolRecentSearchValues:[]})},positionRecentSearchValues:[],setPositionRecentSearchValues:s=>{e({positionRecentSearchValues:s})},addPositionRecentSearchValue:s=>{e(e=>{const a=d(s);return e.positionRecentSearchValues.some(e=>d(e)===a)?e:{positionRecentSearchValues:[s,...e.positionRecentSearchValues]}})},removePositionRecentSearchValue:s=>{e(e=>({positionRecentSearchValues:e.positionRecentSearchValues.filter(e=>d(e)!==d(s))}))},clearPositionRecentSearchValues:()=>{e({positionRecentSearchValues:[]})},searchTab:"pool",setSearchTab:s=>{e({searchTab:s})},resetPoolInput:()=>{e({searchWalletAddress:"",searchPoolAddress:"",poolYieldData:void 0,walletErrorString:void 0,poolErrorString:void 0,poolSearchLoading:!1})},resetPositionInput:()=>{e({searchPositionId:"",positionYieldData:void 0,positionErrorString:void 0,positionSearching:!1})},resetInput:()=>{e({searchTab:"pool",searchWalletAddress:"",searchPoolAddress:"",searchPositionId:"",poolYieldData:void 0,positionYieldData:void 0,walletErrorString:void 0,poolErrorString:void 0,positionErrorString:void 0,poolSearchLoading:!1,positionSearching:!1})}}),{name:"useYieldStore",partialize:e=>({poolRecentSearchValues:e.poolRecentSearchValues,positionRecentSearchValues:e.positionRecentSearchValues})}));function _(){const{yieldTabs:e,searchTab:s,handleTabChange:l}=function(){const{searchTab:e,setSearchTab:s}=T(),{pathname:i}=a(),n=o(),l=r();return t.useEffect(()=>{i.startsWith("/yield")&&("position"===n?.type?(l("/yield/position"),s("position")):(l("/yield/pool"),s("pool")))},[i,n?.type]),{yieldTabs:[{label:"Pool Yield",value:"pool"},{label:"Position Yield",value:"position"}],searchTab:e,handleTabChange:e=>{s(e.value),i.startsWith("/yield")&&l(`/yield/${e.value}`)}}}();return i.jsx(n,{w:"100%",borderBottom:"1px solid",borderColor:"primary.10",children:i.jsx(u,{tabs:e,activeTab:s,onChange:l,wrapStyle:{w:"fit-content",overflowX:"auto",scrollbarGutter:"stable",scrollbarWidth:"none"}})})}function A({walletInputOptions:e,poolInputOptions:a,wrapStyle:o={},enterStyle:r={},isLoading:t,handleEnter:n,onFocus:l,onBlur:c}){const d=t||!e?.value||!a?.value,{isApp:u}=R();return i.jsxs(s,{gap:"4px",w:"full",...o,children:[i.jsx(h,{showEnter:!1,...e,onFocus:l,onBlur:c}),i.jsx(h,{showEnter:!1,...a,onFocus:l,onBlur:c}),i.jsx(V,{onClick:n,cursor:d?"not-allowed":"pointer",bg:{base:d?"primary.60":"primary",lg:"primary.60"},_hover:d?void 0:{bg:"primary"},opacity:d?.6:1,flex:{base:"0 0 32px",lg:"0 0 44px"},h:{base:"32px",lg:"44px"},justify:"center",align:"center",borderRadius:"0px",...r,children:t?i.jsx(p,{w:"16px",h:"16px"}):i.jsx(E,{name:"icon-icon_search",boxSize:u?"12px":"16px",color:"primary_bg",_hover:{fill:"primary_bg"}})})]})}function D(){const{walletErrorString:e,setWalletErrorString:s,poolErrorString:a,setPoolErrorString:o,setPoolSearchLoading:r,poolRecentSearchValues:i,addPoolRecentSearchValue:n,setPoolRecentSearchValues:l,setPoolYieldData:c,setSearchPoolAddress:u,setSearchWalletAddress:h,searchPoolAddress:p,searchWalletAddress:f,poolSearchLoading:b}=T(),{findSearchResult:y}=function(){const{fetchByApi:e}=g(),{suiClient:s}=S(),{setIsDlmm:a}=T();return{findSearchResult:async(o,r)=>{let t;try{const e=await s._client.getObject({id:r,options:{showType:!0,showContent:!0}}),a=e?.data?.content;t=!("moveObject"!==a?.dataType||!a.fields?.bin_manager)}catch(i){try{const s=await e(P,"GET",{wallet_address:o,pool:r});if(s?.pool)return a(!0),{status:"success",data:s};{const s=await e(m,"GET",{wallet_address:o,pool:r});return s?.pool?(a(!1),{status:"success",data:s}):{status:"error",errorMessage:"missing data"}}}catch(n){return{status:"error",errorMessage:"missing data"}}}a(t);try{const s=await e(t?P:m,"GET",{wallet_address:o,pool:r});return s?.pool?{status:"success",data:s}:{status:"error",errorMessage:"missing data"}}catch(i){return null}}}}();t.useEffect(()=>{a&&(p?v(p)?o(""):o("Please enter a valid address"):o(""))},[p,a]),t.useEffect(()=>{e&&(f?v(f)?s(""):s("Please enter a valid address"):s(""))},[f,e]);const R=async(e,a)=>{if(e?v(e)?o(""):o("Please enter a valid address"):o(""),a?v(a)?s(""):s("Please enter a valid address"):s(""),e&&a){if(v(a)&&v(e)){r(!0);try{const s=await y(a,e);if(s&&"success"===s.status){const o=s.data;return c(o),n({search_value:a,sub_search_value:e}),s}{const e={errorMessage:"missing data"};return c(e),e}}catch(t){const e={errorMessage:"missing data"};return c(e),e}finally{r(!1)}}}};return{searchPoolAddress:p,searchWalletAddress:f,setSearchPoolAddress:u,setSearchWalletAddress:h,handleSearch:R,walletErrorString:e,poolErrorString:a,poolSearchLoading:b,handleValueClick:e=>{h(e?.search_value),u(e?.sub_search_value??""),R(e?.sub_search_value??"",e?.search_value);const s=i?.filter(s=>d(s)!==d(e));l([e,...s])}}}function I(){const{positionErrorString:e,setPositionErrorString:s,setPositionSearching:a,positionRecentSearchValues:o,addPositionRecentSearchValue:r,setPositionRecentSearchValues:i,setPositionYieldData:n,searchPositionId:l,setSearchPositionId:c,positionSearching:u}=T(),{findSearchResult:h}=function(){const{fetchByApi:e}=g(),{setIsDlmm:s}=T();return{findSearchResult:async a=>{try{const o=await e(f,"GET",{identifier:a});return o?.pool?(s(void 0!==o?.binStep),{status:"success",data:o}):{status:"error",errorMessage:"missing data"}}catch(o){return null}}}}();t.useEffect(()=>{e&&(l?b(l)||y(l)?s(""):s("Please enter a valid address"):s(""))},[l,e]);const p=async e=>{if(e?b(e)||y(e)?s(""):s("Please enter a valid address"):s(""),e){if(b(e)||y(e)){a(!0);try{const s=await h(e);if(s&&"success"===s.status){const a=s.data;return n({...a,positions:a.positions.sort((e,s)=>Number(s.openPositionTimestamp)-Number(e.openPositionTimestamp))}),r({search_value:e}),s}{const e={errorMessage:"missing data"};return n(e),e}}catch(o){const e={errorMessage:"missing data"};return n(e),e}finally{a(!1)}}}};return{searchPositionId:l,setSearchPositionId:c,handleSearch:p,positionErrorString:e,positionSearching:u,handleValueClick:e=>{c(e?.search_value),p(e?.search_value);const s=o?.filter(s=>d(s)!==d(e));i([e,...s])}}}export{A as G,x as H,_ as Y,I as a,T as b,D as u};
